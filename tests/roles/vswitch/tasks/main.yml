---
- name: Create a new apsarastack VSwitch resource
  alibaba.apsarastack.ali_vswitch:
    apsarastack_zone: '{{ availability_zone }}'
    cidr_block: '{{ vswitch_cidr }}'
    vswitch_name: '{{ name }}'
    description: '{{ vswitch_description }}'
    vpc_id: '{{vpc.vpc.id}}'
  register: vswitch

- name: Get the existing vswitch
  alibaba.apsarastack.ali_vswitch_info:
    name_prefix: '{{ name }}'
    filters:
      vpc_id: '{{vpc.vpc.id}}'
  register: vswitches